#pragma once

#include <easyx.h>

#define MAX_WIDTH 960
#define MAX_HEIGHT 720
#define CELL_LENGTH 32

#define TID_I 1
#define TID_J 2
#define TID_L 3
#define TID_O 4
#define TID_S 5
#define TID_T 6
#define TID_Z 7
#define TID_SHADOW 8

#define RST_0 0
#define RST_R 1
#define RST_2 2
#define RST_L 3

#define X_POS 0
#define Y_POS 1

#undef BLUE
#define BLUE 0xFF6666
#define ORANGE 0x00AAFF

#define D_CYAN 0x666600
#define D_BLUE 0xAA3333
#define D_ORANGE 0x0066AA
#define D_YELLOW 0x00AAAA
#define D_GREEN 0x006600
#define D_MAGENTA 0x660066
#define D_RED 0x000066

typedef int TETROMINO_t;
typedef int ROTSTATE_t;

static const struct Tetromino {
	int shape[4][4][2];
	int wall_kick[4][5][2];
	COLORREF bcolor;
	COLORREF dcolor;
} tetrominoInfo[8] = {
	{
		{
			{{0, 0}, {0, 0}, {0, 0}, {0, 0}},
			{{0, 0}, {0, 0}, {0, 0}, {0, 0}},
			{{0, 0}, {0, 0}, {0, 0}, {0, 0}},
			{{0, 0}, {0, 0}, {0, 0}, {0, 0}},
		}, 
		{
			{{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
			{{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
			{{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
			{{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
		},
		0, 0
	}, // 完全没有意义的占位元素，不要调用他
	{
		{
			{{0, 0}, {-1, 0}, {1, 0}, {2, 0}},
			{{0, 0}, {0, 1}, {0, -1}, {0, -2}},
			{{0, 0}, {1, 0}, {-1, 0}, {-2, 0}},
			{{0, 0}, {0, -1}, {0, 1}, {0, 2}},
		},
		{
			{{0, 0}, {-1, 0}, {+2, 0}, {-1, 0}, {+2, 0}},
			{{-1, 0}, {0, 0}, {0, 0}, {0, +1}, {0, -2}},
			{{-1, +1}, {+1, +1}, {-2, +1}, {+1, 0}, {-2, 0}},
			{{0, +1}, {0, +1}, {0, +1}, {0, -1}, {0, +2}},
		},
		CYAN, D_CYAN
	}, // I tetromino info
	{
		{
			{{0, 0}, {-1, 0}, {-1, 1}, {1, 0}},
			{{0, 0}, {0, 1}, {1, 1}, {0, -1}},
			{{0, 0}, {1, 0}, {1, -1}, {-1, 0}},
			{{0, 0}, {0, -1}, {-1, -1}, {0, 1}},
		},
		{
			{{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
			{{0, 0}, {+1, 0}, {+1, -1}, {0, +2}, {+1, +2}},
			{{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
			{{0, 0}, {-1, 0}, {-1, -1}, {0, +2}, {-1, +2}},
		},
		BLUE, D_BLUE
	}, // J tetromino info
	{
		{
			{{0, 0}, {-1, 0}, {1, 1}, {1, 0}},
			{{0, 0}, {0, 1}, {1, -1}, {0, -1}},
			{{0, 0}, {1, 0}, {-1, -1}, {-1, 0}},
			{{0, 0}, {0, -1}, {-1, 1}, {0, 1}},
		},
		{
			{{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
			{{0, 0}, {+1, 0}, {+1, -1}, {0, +2}, {+1, +2}},
			{{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
			{{0, 0}, {-1, 0}, {-1, -1}, {0, +2}, {-1, +2}},
		},
		ORANGE, D_ORANGE
	}, // L tetromino info
	{
		{
			{{0, 0}, {0, 1}, {1, 1}, {1, 0}},
			{{0, 0}, {1, 0}, {1, -1}, {0, -1}},
			{{0, 0}, {0, -1}, {-1, -1}, {-1, 0}},
			{{0, 0}, {-1, 0}, {-1, 1}, {0, 1}},
		},
		{
			{{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
			{{0, -1}, {0, -1}, {0, -1}, {0, -1}, {0, -1}},
			{{-1, -1}, {-1, -1}, {-1, -1}, {-1, -1}, {-1, -1}},
			{{-1, 0}, {-1, 0}, {-1, 0}, {-1, 0}, {-1, 0}},
		},
		YELLOW, D_YELLOW
	}, // O tetromino info
	{
		{
			{{0, 0}, {0, 1}, {1, 1}, {-1, 0}},
			{{0, 0}, {1, 0}, {1, -1}, {0, 1}},
			{{0, 0}, {0, -1}, {-1, -1}, {1, 0}},
			{{0, 0}, {-1, 0}, {-1, 1}, {0, -1}},
		},
		{
			{{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
			{{0, 0}, {+1, 0}, {+1, -1}, {0, +2}, {+1, +2}},
			{{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
			{{0, 0}, {-1, 0}, {-1, -1}, {0, +2}, {-1, +2}},
		},
		GREEN, D_GREEN
	}, // S tetromino info
	{
		{
			{{0, 0}, {-1, 0}, {0, 1}, {1, 0}},
			{{0, 0}, {0, 1}, {1, 0}, {0, -1}},
			{{0, 0}, {1, 0}, {0, -1}, {-1, 0}},
			{{0, 0}, {0, -1}, {-1, 0}, {0, 1}},
		},
		{
			{{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
			{{0, 0}, {+1, 0}, {+1, -1}, {0, +2}, {+1, +2}},
			{{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
			{{0, 0}, {-1, 0}, {-1, -1}, {0, +2}, {-1, +2}},
		},
		MAGENTA, D_MAGENTA
	}, // T tetromino info
	{
		{
			{{0, 0}, {0, 1}, {-1, 1}, {1, 0}},
			{{0, 0}, {1, 0}, {1, 1}, {0, -1}},
			{{0, 0}, {0, -1}, {1, -1}, {-1, 0}},
			{{0, 0}, {-1, 0}, {-1, -1}, {0, 1}},
		},
		{
			{{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
			{{0, 0}, {+1, 0}, {+1, -1}, {0, +2}, {+1, +2}},
			{{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
			{{0, 0}, {-1, 0}, {-1, -1}, {0, +2}, {-1, +2}},
		},
		RED, D_RED
	}, // Z tetromino info
};